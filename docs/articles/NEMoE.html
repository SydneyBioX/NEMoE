<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started: NEMoE • NEMoE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started: NEMoE">
<meta property="og:description" content="NEMoE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NEMoE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/NEMoE.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="NEMoE_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started: NEMoE</h1>
            
      
      
      <div class="hidden name"><code>NEMoE.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Nutrition-Enterotype Mixture of Expert Model(NEMoE) is an R package that facilitates discover latent classes shaped by nutrition intake that makes relationship between gut microbiome and health outcome different.</p>
<p>The methods use a regularized mixture of experts model framework identify such latent classes and using EM algorithm to fitting the parameters in the model. The overall workflow of NEMoE are describe in the following figure:</p>
<p><img src="../inst/figures/workflow.jpg" alt="workflow"> NEMoE use the nutrition data, microbiome data and health outcome as input to identify latent class based on the nutrients intake as well as the corresponding diet related microbiome signatures of disease.</p>
<p>In this vignette, we go through a 16S microbiome data of Parkinson’s disease to identify the latent classes shaped by nutrition intake and finding the microbiome signatures for each latent class.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">NEMoE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217">phyloseq</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="gut-microbiome-and-parkinsons-disease" class="section level1">
<h1 class="hasAnchor">
<a href="#gut-microbiome-and-parkinsons-disease" class="anchor"></a>Gut microbiome and Parkinson’s disease</h1>
<p>The <code>PD</code> dataset contain data from a gut microbiome-Parkinson’s disease study, the nutrition intake of each individual is also provided from food frequency questionnaire. We provide two type of the data(i.e. phyloseq object and a list) to construct input of NEMoE.</p>
<p>In this example, we will use NEMoE to identify two latent class of different nutrition pattern with altered microbiome-PD relationships and identify the related nutrition features for the latent class and microbiome signatures for each latent class.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"PD"</span><span class="op">)</span></code></pre></div>
<div id="build-the-nemoe-object-from-list" class="section level2">
<h2 class="hasAnchor">
<a href="#build-the-nemoe-object-from-list" class="anchor"></a>Build the <code>NEMoE</code> object from list</h2>
<p>First we build the <code>NEMoE</code> object, the input data to build <code>NEMoE</code> have three part: microbiome data, nutrition data and health outcome. The nutrition data can be either matrix or dataframe which each row is a sample and each column is a nutrient. The microbiome data can be either a list of table that contain several microbiome matrix where each row is a sample and each column is a taxa (at the level) or a <code>phyloseq</code>. The response is a vector of different health state.</p>
<p>In the following example, we build <code>NEMoE</code> object from list of microbiome data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Microbiome</span> <span class="op">=</span> <span class="va">PD</span><span class="op">$</span><span class="va">data_list</span><span class="op">$</span><span class="va">Microbiome</span>
<span class="va">Nutrition</span> <span class="op">=</span> <span class="va">PD</span><span class="op">$</span><span class="va">data_list</span><span class="op">$</span><span class="va">Nutrition</span>
<span class="va">Response</span> <span class="op">=</span> <span class="va">PD</span><span class="op">$</span><span class="va">data_list</span><span class="op">$</span><span class="va">Response</span></code></pre></div>
<p>NEMoE object can also incorporate the parameters used in the fitting, including <code>K</code>,<code>lambda1</code>, <code>lambda2</code>, <code>alpha1</code>, <code>alpha2</code> and <code>cvParams</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NEMoE</span> <span class="op">=</span> <span class="fu"><a href="../reference/NEMoE_buildFromList.html">NEMoE_buildFromList</a></span><span class="op">(</span><span class="va">Microbiome</span>, <span class="va">Nutrition</span>, <span class="va">Response</span>, K <span class="op">=</span> <span class="fl">2</span>, 
                            lambda1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.014</span>, <span class="fl">0.016</span>, <span class="fl">0.023</span>, <span class="fl">0.025</span><span class="op">)</span>,
                            lambda2 <span class="op">=</span> <span class="fl">0.02</span>, alpha1 <span class="op">=</span> <span class="fl">0.5</span>, alpha2 <span class="op">=</span> <span class="fl">0.5</span>,
                            cvParams <span class="op">=</span> <span class="fu"><a href="../reference/createCVList.html">createCVList</a></span><span class="op">(</span>g1 <span class="op">=</span> <span class="fl">10</span>, shrink <span class="op">=</span> <span class="fl">0.4</span>,
                                                    track <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="fit-the-nemoe-object" class="section level3">
<h3 class="hasAnchor">
<a href="#fit-the-nemoe-object" class="anchor"></a>Fit the <code>NEMoE</code> object</h3>
<p>Now using the <code>fitNEMoE</code> function, we can fit <code>NEMoE</code> object with the specified parameters in the <code>NEMoE</code> object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NEMoE</span> <span class="op">=</span> <span class="fu"><a href="../reference/fitNEMoE.html">fitNEMoE</a></span><span class="op">(</span><span class="va">NEMoE</span><span class="op">)</span>
<span class="co">#&gt; Fitting NEMoE.... </span>
<span class="co">#&gt; it: 0, PLL0:-501.619</span>
<span class="co">#&gt; it: 1, PLL:-500.746</span>
<span class="co">#&gt; it: 2, PLL:-499.965</span>
<span class="co">#&gt; it: 3, PLL:-499.247</span>
<span class="co">#&gt; it: 4, PLL:-498.522</span>
<span class="co">#&gt; it: 5, PLL:-497.749</span>
<span class="co">#&gt; it: 6, PLL:-496.892</span>
<span class="co">#&gt; it: 7, PLL:-495.909</span>
<span class="co">#&gt; it: 8, PLL:-494.746</span>
<span class="co">#&gt; it: 9, PLL:-493.337</span>
<span class="co">#&gt; it: 10, PLL:-491.622</span>
<span class="co">#&gt; it: 11, PLL:-489.529</span>
<span class="co">#&gt; it: 12, PLL:-487.006</span>
<span class="co">#&gt; it: 13, PLL:-484.229</span>
<span class="co">#&gt; it: 14, PLL:-481.513</span>
<span class="co">#&gt; it: 15, PLL:-479.01</span>
<span class="co">#&gt; it: 16, PLL:-476.819</span>
<span class="co">#&gt; it: 17, PLL:-475.002</span>
<span class="co">#&gt; it: 18, PLL:-473.644</span>
<span class="co">#&gt; it: 19, PLL:-472.703</span>
<span class="co">#&gt; it: 20, PLL:-472.1</span>
<span class="co">#&gt; it: 21, PLL:-471.708</span>
<span class="co">#&gt; it: 22, PLL:-471.444</span>
<span class="co">#&gt; it: 23, PLL:-471.266</span>
<span class="co">#&gt; it: 24, PLL:-471.143</span>
<span class="co">#&gt; it: 25, PLL:-471.058</span>
<span class="co">#&gt; it: 26, PLL:-471.001</span>
<span class="co">#&gt; it: 27, PLL:-470.963</span>
<span class="co">#&gt; it: 28, PLL:-470.935</span>
<span class="co">#&gt; it: 29, PLL:-470.914</span>
<span class="co">#&gt; it: 30, PLL:-470.897</span>
<span class="co">#&gt; it: 31, PLL:-470.883</span>
<span class="co">#&gt; it: 32, PLL:-470.871</span>
<span class="co">#&gt; it: 33, PLL:-470.86</span>
<span class="co">#&gt; it: 34, PLL:-470.851</span>
<span class="co">#&gt; it: 35, PLL:-470.842</span>
<span class="co">#&gt; it: 36, PLL:-470.833</span>
<span class="co">#&gt; it: 37, PLL:-470.824</span>
<span class="co">#&gt; it: 38, PLL:-470.814</span>
<span class="co">#&gt; it: 39, PLL:-470.803</span>
<span class="co">#&gt; it: 40, PLL:-470.789</span>
<span class="co">#&gt; it: 41, PLL:-470.771</span>
<span class="co">#&gt; it: 42, PLL:-470.75</span>
<span class="co">#&gt; it: 43, PLL:-470.73</span>
<span class="co">#&gt; it: 44, PLL:-470.71</span>
<span class="co">#&gt; it: 45, PLL:-470.692</span>
<span class="co">#&gt; it: 46, PLL:-470.674</span>
<span class="co">#&gt; it: 47, PLL:-470.656</span>
<span class="co">#&gt; it: 48, PLL:-470.638</span>
<span class="co">#&gt; it: 49, PLL:-470.621</span>
<span class="co">#&gt; it: 50, PLL:-470.603</span>
<span class="co">#&gt; it: 51, PLL:-470.585</span>
<span class="co">#&gt; it: 52, PLL:-470.569</span>
<span class="co">#&gt; it: 53, PLL:-470.555</span>
<span class="co">#&gt; it: 54, PLL:-470.542</span>
<span class="co">#&gt; it: 55, PLL:-470.53</span>
<span class="co">#&gt; it: 56, PLL:-470.52</span>
<span class="co">#&gt; it: 57, PLL:-470.511</span>
<span class="co">#&gt; it: 58, PLL:-470.5</span>
<span class="co">#&gt; it: 59, PLL:-470.492</span>
<span class="co">#&gt; it: 60, PLL:-470.481</span>
<span class="co">#&gt; it: 61, PLL:-470.471</span>
<span class="co">#&gt; it: 62, PLL:-470.47</span>
<span class="co">#&gt; it: 63, PLL:-470.47</span>
<span class="co">#&gt; it: 64, PLL:-470.47</span>
<span class="co">#&gt; it: 65, PLL:-470.47</span>
<span class="co">#&gt; it: 66, PLL:-470.469</span>
<span class="co">#&gt; it: 67, PLL:-470.469</span>
<span class="co">#&gt; it: 68, PLL:-470.469</span></code></pre></div>
<p>The fitted log-likelihood can be get from <code>getLL</code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/getLL.html">getLL</a></span><span class="op">(</span><span class="va">NEMoE</span><span class="op">)</span>
<span class="co">#&gt;            LL_obs   PLL_obs LL_complete PLL_complete</span>
<span class="co">#&gt; Phylum  -90.29506 -117.7473   -147.2789    -174.7311</span>
<span class="co">#&gt; Order   -84.96665 -116.4175   -139.6226    -171.0734</span>
<span class="co">#&gt; Family  -82.71688 -115.5229   -139.3969    -172.2029</span>
<span class="co">#&gt; Genus   -78.65367 -113.8171   -144.3031    -179.4665</span>
<span class="co">#&gt; ASV     -64.79430 -109.3006   -133.2118    -177.7181</span>
<span class="co">#&gt; All    -401.42655 -470.4693   -703.8133    -772.8560</span></code></pre></div>
<p>The corresponding coefficients in gating function, i.e. the effect size of each nutrition variables of their contribution to the different latent class can be obtained from <code>getCoef</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coef.Gating</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCoef.html">getCoef</a></span><span class="op">(</span><span class="va">NEMoE</span><span class="op">)</span><span class="op">$</span><span class="va">coef.gating</span></code></pre></div>
<p>These coefficients of gating network can be plotted by <code>plotGating</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotGating.html">plotGating</a></span><span class="op">(</span><span class="va">NEMoE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<p>The corresponding coefficients in experts network, i.e. the effect size of each microbiome features of their contribution to health outcome (PD state here) in different latent class can be obtained from <code>getCoef</code> function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coef.Experts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCoef.html">getCoef</a></span><span class="op">(</span><span class="va">NEMoE</span><span class="op">)</span><span class="op">$</span><span class="va">coef.experts</span></code></pre></div>
<p>These coefficients of experts network can be plotted by <code>plotGating</code> function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotExperts.html">plotExperts</a></span><span class="op">(</span><span class="va">NEMoE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Phylum level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Order level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Family level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-15-1.png" width="768"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Genus level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-16-1.png" width="768"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of ASV level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
</div>
<div id="single-level-nemoe" class="section level3">
<h3 class="hasAnchor">
<a href="#single-level-nemoe" class="anchor"></a>Single level <code>NEMoE</code>
</h3>
<p><code>NEMoE</code> can also built based on single level data, we illustrated it using <code>Genus</code> level of the Microbiome-PD dataset.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Microbiome_gen</span> <span class="op">&lt;-</span> <span class="va">Microbiome</span><span class="op">$</span><span class="va">Genus</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NEMoE_gen</span> <span class="op">=</span> <span class="fu"><a href="../reference/NEMoE_buildFromList.html">NEMoE_buildFromList</a></span><span class="op">(</span><span class="va">Microbiome_gen</span>, <span class="va">Nutrition</span>, <span class="va">Response</span>, K <span class="op">=</span> <span class="fl">2</span>, 
                            lambda1 <span class="op">=</span> <span class="fl">0.028</span>, lambda2 <span class="op">=</span> <span class="fl">0.02</span>,
                            alpha1 <span class="op">=</span> <span class="fl">0.5</span>, alpha2 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NEMoE_gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitNEMoE.html">fitNEMoE</a></span><span class="op">(</span><span class="va">NEMoE_gen</span>, restart_it <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="co">#&gt; Fitting NEMoE.... </span>
<span class="co">#&gt; it: 0, PLL0:-101.423</span>
<span class="co">#&gt; it: 1, PLL:-101.359</span>
<span class="co">#&gt; it: 2, PLL:-101.294</span>
<span class="co">#&gt; it: 3, PLL:-101.228</span>
<span class="co">#&gt; it: 4, PLL:-101.163</span>
<span class="co">#&gt; it: 5, PLL:-101.1</span>
<span class="co">#&gt; it: 6, PLL:-101.032</span>
<span class="co">#&gt; it: 7, PLL:-100.957</span>
<span class="co">#&gt; it: 8, PLL:-100.871</span>
<span class="co">#&gt; it: 9, PLL:-100.768</span>
<span class="co">#&gt; it: 10, PLL:-100.634</span>
<span class="co">#&gt; it: 11, PLL:-100.453</span>
<span class="co">#&gt; it: 12, PLL:-100.222</span>
<span class="co">#&gt; it: 13, PLL:-99.9147</span>
<span class="co">#&gt; it: 14, PLL:-99.5009</span>
<span class="co">#&gt; it: 15, PLL:-98.9517</span>
<span class="co">#&gt; it: 16, PLL:-98.2935</span>
<span class="co">#&gt; it: 17, PLL:-97.5981</span>
<span class="co">#&gt; it: 18, PLL:-96.9549</span>
<span class="co">#&gt; it: 19, PLL:-96.4377</span>
<span class="co">#&gt; it: 20, PLL:-96.048</span>
<span class="co">#&gt; it: 21, PLL:-95.7756</span>
<span class="co">#&gt; it: 22, PLL:-95.5959</span>
<span class="co">#&gt; it: 23, PLL:-95.4771</span>
<span class="co">#&gt; it: 24, PLL:-95.3956</span>
<span class="co">#&gt; it: 25, PLL:-95.3385</span>
<span class="co">#&gt; it: 26, PLL:-95.2966</span>
<span class="co">#&gt; it: 27, PLL:-95.2642</span>
<span class="co">#&gt; it: 28, PLL:-95.2377</span>
<span class="co">#&gt; it: 29, PLL:-95.2153</span>
<span class="co">#&gt; it: 30, PLL:-95.1957</span>
<span class="co">#&gt; it: 31, PLL:-95.1782</span>
<span class="co">#&gt; it: 32, PLL:-95.1622</span>
<span class="co">#&gt; it: 33, PLL:-95.1478</span>
<span class="co">#&gt; it: 34, PLL:-95.1354</span>
<span class="co">#&gt; it: 35, PLL:-95.1246</span>
<span class="co">#&gt; it: 36, PLL:-95.1153</span>
<span class="co">#&gt; it: 37, PLL:-95.1073</span>
<span class="co">#&gt; it: 38, PLL:-95.1003</span>
<span class="co">#&gt; it: 39, PLL:-95.0943</span>
<span class="co">#&gt; it: 40, PLL:-95.0891</span>
<span class="co">#&gt; it: 41, PLL:-95.0846</span>
<span class="co">#&gt; it: 42, PLL:-95.0807</span>
<span class="co">#&gt; it: 43, PLL:-95.0774</span>
<span class="co">#&gt; it: 44, PLL:-95.0745</span>
<span class="co">#&gt; it: 45, PLL:-95.072</span>
<span class="co">#&gt; it: 46, PLL:-95.0699</span>
<span class="co">#&gt; it: 47, PLL:-95.0681</span>
<span class="co">#&gt; it: 48, PLL:-95.0666</span>
<span class="co">#&gt; it: 49, PLL:-95.0652</span>
<span class="co">#&gt; it: 50, PLL:-95.0641</span>
<span class="co">#&gt; it: 51, PLL:-95.0631</span>
<span class="co">#&gt; it: 52, PLL:-95.0623</span>
<span class="co">#&gt; it: 53, PLL:-95.0616</span>
<span class="co">#&gt; it: 54, PLL:-95.0611</span>
<span class="co">#&gt; it: 55, PLL:-95.0606</span>
<span class="co">#&gt; it: 56, PLL:-95.0602</span>
<span class="co">#&gt; it: 57, PLL:-95.0598</span>
<span class="co">#&gt; it: 58, PLL:-95.0596</span>
<span class="co">#&gt; it: 59, PLL:-95.0593</span>
<span class="co">#&gt; it: 60, PLL:-95.0592</span>
<span class="co">#&gt; it: 61, PLL:-95.059</span>
<span class="co">#&gt; it: 62, PLL:-95.0589</span>
<span class="co">#&gt; it: 63, PLL:-95.0588</span>
<span class="co">#&gt; it: 64, PLL:-95.0587</span>
<span class="co">#&gt; it: 65, PLL:-95.0587</span>
<span class="co">#&gt; it: 66, PLL:-95.0586</span>
<span class="co">#&gt; it: 67, PLL:-95.0586</span>
<span class="co">#&gt; it: 68, PLL:-95.0586</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotGating.html">plotGating</a></span><span class="op">(</span><span class="va">NEMoE_gen</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-22-1.png" width="768"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-23-1.png" width="768"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotExperts.html">plotExperts</a></span><span class="op">(</span><span class="va">NEMoE_gen</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-24-1.png" width="768"></p>
</div>
</div>
<div id="build-the-nemoe-object-from-phyloseq" class="section level2">
<h2 class="hasAnchor">
<a href="#build-the-nemoe-object-from-phyloseq" class="anchor"></a>Build the <code>NEMoE</code> object from phyloseq</h2>
<p>In parallel, <code>NEMoE</code> object can be built from <code>phyloseq</code> object from the microbiome counts data. <code>NEMoE</code> wrapper functions for TSS normalization and transformations of the counts data. Also which levels of the data incorporated in the data can be determined by user.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_PD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">PD</span><span class="op">$</span><span class="va">ps</span><span class="op">)</span>
<span class="va">Response</span> <span class="op">&lt;-</span> <span class="va">sample_PD</span><span class="op">$</span><span class="va">PD</span>
<span class="va">Nutrition</span> <span class="op">&lt;-</span> <span class="va">sample_PD</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">sample_PD</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>In the following example, we first TSS normalized data, then filter the taxa with prevalance larger than 0.7 (i.e. the taxa non-zero in more than 70% of the sample) and variance larger than 5e-5. Then the data are further tranformed using arcsin transformation and zscored. The resulting Microbiome data is to used built <code>NEMoE</code> object.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NEMoE_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NEMoE_buildFromPhyloseq.html">NEMoE_buildFromPhyloseq</a></span><span class="op">(</span>ps <span class="op">=</span> <span class="va">PD</span><span class="op">$</span><span class="va">ps</span>, Nutrition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">Nutrition</span><span class="op">)</span>,
                                 Response <span class="op">=</span> <span class="va">Response</span>,  K <span class="op">=</span> <span class="fl">2</span>, 
                                 lambda1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.014</span>, <span class="fl">0.016</span>, <span class="fl">0.023</span>, <span class="fl">0.025</span><span class="op">)</span>,
                                 lambda2 <span class="op">=</span> <span class="fl">0.02</span>, alpha1 <span class="op">=</span> <span class="fl">0.5</span>, alpha2 <span class="op">=</span> <span class="fl">0.5</span>,
                                 filtParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>prev <span class="op">=</span> <span class="fl">0.7</span>, var <span class="op">=</span> <span class="fl">1e-5</span><span class="op">)</span>,
                                 transParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"asin"</span>, scale <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,
                                 taxLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Phylum"</span>,<span class="st">"Order"</span>,<span class="st">"Family"</span>,
                                              <span class="st">"Genus"</span>,<span class="st">"ASV"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The <code>NEMoE</code> object can also be fitted and visualized as it is in the previous section.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NEMoE_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitNEMoE.html">fitNEMoE</a></span><span class="op">(</span><span class="va">NEMoE_ps</span><span class="op">)</span>
<span class="co">#&gt; Fitting NEMoE.... </span>
<span class="co">#&gt; it: 0, PLL0:-494.62</span>
<span class="co">#&gt; it: 1, PLL:-493.94</span>
<span class="co">#&gt; it: 2, PLL:-493.284</span>
<span class="co">#&gt; it: 3, PLL:-492.686</span>
<span class="co">#&gt; it: 4, PLL:-492.094</span>
<span class="co">#&gt; it: 5, PLL:-491.481</span>
<span class="co">#&gt; it: 6, PLL:-490.83</span>
<span class="co">#&gt; it: 7, PLL:-490.129</span>
<span class="co">#&gt; it: 8, PLL:-489.357</span>
<span class="co">#&gt; it: 9, PLL:-488.485</span>
<span class="co">#&gt; it: 10, PLL:-487.511</span>
<span class="co">#&gt; it: 11, PLL:-486.401</span>
<span class="co">#&gt; it: 12, PLL:-485.14</span>
<span class="co">#&gt; it: 13, PLL:-483.711</span>
<span class="co">#&gt; it: 14, PLL:-482.088</span>
<span class="co">#&gt; it: 15, PLL:-480.307</span>
<span class="co">#&gt; it: 16, PLL:-478.45</span>
<span class="co">#&gt; it: 17, PLL:-476.66</span>
<span class="co">#&gt; it: 18, PLL:-475.071</span>
<span class="co">#&gt; it: 19, PLL:-473.713</span>
<span class="co">#&gt; it: 20, PLL:-472.585</span>
<span class="co">#&gt; it: 21, PLL:-471.669</span>
<span class="co">#&gt; it: 22, PLL:-470.943</span>
<span class="co">#&gt; it: 23, PLL:-470.389</span>
<span class="co">#&gt; it: 24, PLL:-469.979</span>
<span class="co">#&gt; it: 25, PLL:-469.67</span>
<span class="co">#&gt; it: 26, PLL:-469.436</span>
<span class="co">#&gt; it: 27, PLL:-469.256</span>
<span class="co">#&gt; it: 28, PLL:-469.116</span>
<span class="co">#&gt; it: 29, PLL:-469.004</span>
<span class="co">#&gt; it: 30, PLL:-468.932</span>
<span class="co">#&gt; it: 31, PLL:-468.885</span>
<span class="co">#&gt; it: 32, PLL:-468.852</span>
<span class="co">#&gt; it: 33, PLL:-468.827</span>
<span class="co">#&gt; it: 34, PLL:-468.81</span>
<span class="co">#&gt; it: 35, PLL:-468.797</span>
<span class="co">#&gt; it: 36, PLL:-468.789</span>
<span class="co">#&gt; it: 37, PLL:-468.782</span>
<span class="co">#&gt; it: 38, PLL:-468.777</span>
<span class="co">#&gt; it: 39, PLL:-468.773</span>
<span class="co">#&gt; it: 40, PLL:-468.77</span>
<span class="co">#&gt; it: 41, PLL:-468.767</span>
<span class="co">#&gt; it: 42, PLL:-468.766</span>
<span class="co">#&gt; it: 43, PLL:-468.764</span>
<span class="co">#&gt; it: 44, PLL:-468.763</span>
<span class="co">#&gt; it: 45, PLL:-468.762</span>
<span class="co">#&gt; it: 46, PLL:-468.761</span>
<span class="co">#&gt; it: 47, PLL:-468.761</span>
<span class="co">#&gt; it: 48, PLL:-468.761</span>
<span class="co">#&gt; it: 49, PLL:-468.76</span>
<span class="co">#&gt; it: 50, PLL:-468.76</span>
<span class="co">#&gt; it: 51, PLL:-468.76</span>
<span class="co">#&gt; it: 52, PLL:-468.76</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotGating.html">plotGating</a></span><span class="op">(</span><span class="va">NEMoE_ps</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-29-1.png" width="768"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-30-1.png" width="768"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotExperts.html">plotExperts</a></span><span class="op">(</span><span class="va">NEMoE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Phylum level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-32-1.png" width="768"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Order level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-33-1.png" width="768"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Family level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-34-1.png" width="768"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Genus level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-35-1.png" width="768"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of ASV level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-36-1.png" width="768"></p>
</div>
<div id="evaluation-and-cross-validation-of-nemoe" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluation-and-cross-validation-of-nemoe" class="anchor"></a>Evaluation and cross validation of NEMoE</h2>
<p>We provide many metric including statistics such as <code>AIC</code>, <code>BIC</code> and <code>ICL</code> and cross validation metric such as cross validation accuracy and AUC.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calcCriterion.html">calcCriterion</a></span><span class="op">(</span><span class="va">NEMoE</span>, <span class="st">"all"</span><span class="op">)</span>
<span class="co">#&gt;            AIC       BIC      ICL1      ICL2     eBIC      mAIC      mBIC</span>
<span class="co">#&gt; [1,] -996.8531 -1299.878 -1601.627 -1904.651 -1662.26 -1028.853 -1311.193</span>
<span class="co">#&gt;          mICL1     mICL2  accuracy  D.square       TPR      TNR        F1</span>
<span class="co">#&gt; [1,] -1633.627 -1915.966 0.6904412 0.1508229 0.7907833 0.561678 0.7411134</span>
<span class="co">#&gt;            auc</span>
<span class="co">#&gt; [1,] 0.7766071</span></code></pre></div>
<p>Also the one can use this procedure to select parameters.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NEMoE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cvNEMoE.html">cvNEMoE</a></span><span class="op">(</span><span class="va">NEMoE</span><span class="op">)</span></code></pre></div>
<p>The selected parameters obtained from the cross validation result can be used to fitting the model.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lambda1_choose</span> <span class="op">&lt;-</span> <span class="va">NEMoE</span><span class="op">@</span><span class="va">cvResult</span><span class="op">$</span><span class="va">lambda1_choose</span>
<span class="va">lambda2_choose</span> <span class="op">&lt;-</span> <span class="va">NEMoE</span><span class="op">@</span><span class="va">cvResult</span><span class="op">$</span><span class="va">lambda2_choose</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NEMoE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setParam.html">setParam</a></span><span class="op">(</span><span class="va">NEMoE</span>, lambda1 <span class="op">=</span> <span class="va">lambda1_choose</span>, lambda2 <span class="op">=</span> <span class="va">lambda2_choose</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NEMoE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitNEMoE.html">fitNEMoE</a></span><span class="op">(</span><span class="va">NEMoE</span><span class="op">)</span>
<span class="co">#&gt; Fitting NEMoE.... </span>
<span class="co">#&gt; it: 0, PLL0:-501.999</span>
<span class="co">#&gt; it: 1, PLL:-501.178</span>
<span class="co">#&gt; it: 2, PLL:-500.423</span>
<span class="co">#&gt; it: 3, PLL:-499.665</span>
<span class="co">#&gt; it: 4, PLL:-498.831</span>
<span class="co">#&gt; it: 5, PLL:-497.887</span>
<span class="co">#&gt; it: 6, PLL:-496.796</span>
<span class="co">#&gt; it: 7, PLL:-495.556</span>
<span class="co">#&gt; it: 8, PLL:-494.065</span>
<span class="co">#&gt; it: 9, PLL:-492.29</span>
<span class="co">#&gt; it: 10, PLL:-490.307</span>
<span class="co">#&gt; it: 11, PLL:-488.146</span>
<span class="co">#&gt; it: 12, PLL:-485.955</span>
<span class="co">#&gt; it: 13, PLL:-483.94</span>
<span class="co">#&gt; it: 14, PLL:-482.116</span>
<span class="co">#&gt; it: 15, PLL:-480.472</span>
<span class="co">#&gt; it: 16, PLL:-479.108</span>
<span class="co">#&gt; it: 17, PLL:-478.112</span>
<span class="co">#&gt; it: 18, PLL:-477.387</span>
<span class="co">#&gt; it: 19, PLL:-476.901</span>
<span class="co">#&gt; it: 20, PLL:-476.578</span>
<span class="co">#&gt; it: 21, PLL:-476.35</span>
<span class="co">#&gt; it: 22, PLL:-476.176</span>
<span class="co">#&gt; it: 23, PLL:-476.042</span>
<span class="co">#&gt; it: 24, PLL:-475.942</span>
<span class="co">#&gt; it: 25, PLL:-475.866</span>
<span class="co">#&gt; it: 26, PLL:-475.811</span>
<span class="co">#&gt; it: 27, PLL:-475.772</span>
<span class="co">#&gt; it: 28, PLL:-475.744</span>
<span class="co">#&gt; it: 29, PLL:-475.722</span>
<span class="co">#&gt; it: 30, PLL:-475.705</span>
<span class="co">#&gt; it: 31, PLL:-475.69</span>
<span class="co">#&gt; it: 32, PLL:-475.677</span>
<span class="co">#&gt; it: 33, PLL:-475.665</span>
<span class="co">#&gt; it: 34, PLL:-475.654</span>
<span class="co">#&gt; it: 35, PLL:-475.644</span>
<span class="co">#&gt; it: 36, PLL:-475.636</span>
<span class="co">#&gt; it: 37, PLL:-475.628</span>
<span class="co">#&gt; it: 38, PLL:-475.62</span>
<span class="co">#&gt; it: 39, PLL:-475.612</span>
<span class="co">#&gt; it: 40, PLL:-475.603</span>
<span class="co">#&gt; it: 41, PLL:-475.591</span>
<span class="co">#&gt; it: 42, PLL:-475.577</span>
<span class="co">#&gt; it: 43, PLL:-475.558</span>
<span class="co">#&gt; it: 44, PLL:-475.533</span>
<span class="co">#&gt; it: 45, PLL:-475.507</span>
<span class="co">#&gt; it: 46, PLL:-475.479</span>
<span class="co">#&gt; it: 47, PLL:-475.448</span>
<span class="co">#&gt; it: 48, PLL:-475.414</span>
<span class="co">#&gt; it: 49, PLL:-475.377</span>
<span class="co">#&gt; it: 50, PLL:-475.348</span>
<span class="co">#&gt; it: 51, PLL:-475.323</span>
<span class="co">#&gt; it: 52, PLL:-475.3</span>
<span class="co">#&gt; it: 53, PLL:-475.278</span>
<span class="co">#&gt; it: 54, PLL:-475.257</span>
<span class="co">#&gt; it: 55, PLL:-475.237</span>
<span class="co">#&gt; it: 56, PLL:-475.219</span>
<span class="co">#&gt; it: 57, PLL:-475.202</span>
<span class="co">#&gt; it: 58, PLL:-475.188</span>
<span class="co">#&gt; it: 59, PLL:-475.175</span>
<span class="co">#&gt; it: 60, PLL:-475.166</span>
<span class="co">#&gt; it: 61, PLL:-475.161</span>
<span class="co">#&gt; it: 62, PLL:-475.157</span>
<span class="co">#&gt; it: 63, PLL:-475.153</span>
<span class="co">#&gt; it: 64, PLL:-475.15</span>
<span class="co">#&gt; it: 65, PLL:-475.146</span>
<span class="co">#&gt; it: 66, PLL:-475.143</span>
<span class="co">#&gt; it: 67, PLL:-475.14</span>
<span class="co">#&gt; it: 68, PLL:-475.137</span>
<span class="co">#&gt; it: 69, PLL:-475.133</span>
<span class="co">#&gt; it: 70, PLL:-475.129</span>
<span class="co">#&gt; it: 71, PLL:-475.124</span>
<span class="co">#&gt; it: 72, PLL:-475.118</span>
<span class="co">#&gt; it: 73, PLL:-475.11</span>
<span class="co">#&gt; it: 74, PLL:-475.101</span>
<span class="co">#&gt; it: 75, PLL:-475.088</span>
<span class="co">#&gt; it: 76, PLL:-475.075</span>
<span class="co">#&gt; it: 77, PLL:-475.058</span>
<span class="co">#&gt; it: 78, PLL:-475.038</span>
<span class="co">#&gt; it: 79, PLL:-475.012</span>
<span class="co">#&gt; it: 80, PLL:-474.978</span>
<span class="co">#&gt; it: 81, PLL:-474.935</span>
<span class="co">#&gt; it: 82, PLL:-474.878</span>
<span class="co">#&gt; it: 83, PLL:-474.838</span>
<span class="co">#&gt; it: 84, PLL:-474.807</span>
<span class="co">#&gt; it: 85, PLL:-474.784</span>
<span class="co">#&gt; it: 86, PLL:-474.766</span>
<span class="co">#&gt; it: 87, PLL:-474.753</span>
<span class="co">#&gt; it: 88, PLL:-474.743</span>
<span class="co">#&gt; it: 89, PLL:-474.736</span>
<span class="co">#&gt; it: 90, PLL:-474.731</span>
<span class="co">#&gt; it: 91, PLL:-474.727</span>
<span class="co">#&gt; it: 92, PLL:-474.724</span>
<span class="co">#&gt; it: 93, PLL:-474.723</span>
<span class="co">#&gt; it: 94, PLL:-474.722</span>
<span class="co">#&gt; it: 95, PLL:-474.721</span>
<span class="co">#&gt; it: 96, PLL:-474.721</span>
<span class="co">#&gt; it: 97, PLL:-474.721</span>
<span class="co">#&gt; it: 98, PLL:-474.72</span>
<span class="co">#&gt; it: 99, PLL:-474.72</span>
<span class="co">#&gt; it: 100, PLL:-474.72</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotGating.html">plotGating</a></span><span class="op">(</span><span class="va">NEMoE_ps</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-43-1.png" width="768"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-44-1.png" width="768"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotExperts.html">plotExperts</a></span><span class="op">(</span><span class="va">NEMoE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Phylum level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-46-1.png" width="768"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Order level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-47-1.png" width="768"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Family level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-48-1.png" width="768"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of Genus level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-49-1.png" width="768"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_list</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Coefficients of ASV level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="NEMoE_files/figure-html/unnamed-chunk-50-1.png" width="768"></p>
</div>
</div>
<div id="misc" class="section level1">
<h1 class="hasAnchor">
<a href="#misc" class="anchor"></a>Misc</h1>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.1.0 (2021-05-18)</span>
<span class="co">#&gt; Platform: x86_64-w64-mingw32/x64 (64-bit)</span>
<span class="co">#&gt; Running under: Windows 10 x64 (build 19042)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] LC_COLLATE=Chinese (Simplified)_China.936 </span>
<span class="co">#&gt; [2] LC_CTYPE=Chinese (Simplified)_China.936   </span>
<span class="co">#&gt; [3] LC_MONETARY=Chinese (Simplified)_China.936</span>
<span class="co">#&gt; [4] LC_NUMERIC=C                              </span>
<span class="co">#&gt; [5] LC_TIME=Chinese (Simplified)_China.936    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] phyloseq_1.36.0 NEMoE_1.1.0     ggplot2_3.3.5  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] nlme_3.1-153           bitops_1.0-7           fs_1.5.0              </span>
<span class="co">#&gt;  [4] rprojroot_2.0.2        GenomeInfoDb_1.28.4    tools_4.1.0           </span>
<span class="co">#&gt;  [7] bslib_0.3.0            utf8_1.2.2             R6_2.5.1              </span>
<span class="co">#&gt; [10] vegan_2.5-7            DBI_1.1.1              BiocGenerics_0.38.0   </span>
<span class="co">#&gt; [13] mgcv_1.8-36            colorspace_2.0-2       permute_0.9-5         </span>
<span class="co">#&gt; [16] rhdf5filters_1.4.0     ade4_1.7-17            withr_2.4.2           </span>
<span class="co">#&gt; [19] tidyselect_1.1.1       compiler_4.1.0         glmnet_4.1-2          </span>
<span class="co">#&gt; [22] textshaping_0.3.5      Biobase_2.52.0         desc_1.3.0            </span>
<span class="co">#&gt; [25] labeling_0.4.2         sass_0.4.0             scales_1.1.1          </span>
<span class="co">#&gt; [28] pkgdown_1.6.1          systemfonts_1.0.2      stringr_1.4.0         </span>
<span class="co">#&gt; [31] digest_0.6.27          rmarkdown_2.10         XVector_0.32.0        </span>
<span class="co">#&gt; [34] pkgconfig_2.0.3        htmltools_0.5.2        highr_0.9             </span>
<span class="co">#&gt; [37] fastmap_1.1.0          rlang_0.4.11           shape_1.4.6           </span>
<span class="co">#&gt; [40] jquerylib_0.1.4        generics_0.1.0         farver_2.1.0          </span>
<span class="co">#&gt; [43] jsonlite_1.7.2         mclust_5.4.7           BiocParallel_1.26.2   </span>
<span class="co">#&gt; [46] dplyr_1.0.7            RCurl_1.98-1.4         magrittr_2.0.1        </span>
<span class="co">#&gt; [49] GenomeInfoDbData_1.2.6 biomformat_1.20.0      Matrix_1.3-4          </span>
<span class="co">#&gt; [52] Rcpp_1.0.7             munsell_0.5.0          S4Vectors_0.30.0      </span>
<span class="co">#&gt; [55] Rhdf5lib_1.14.2        fansi_0.5.0            ape_5.5               </span>
<span class="co">#&gt; [58] lifecycle_1.0.0        stringi_1.7.4          yaml_2.2.1            </span>
<span class="co">#&gt; [61] MASS_7.3-54            zlibbioc_1.38.0        rhdf5_2.36.0          </span>
<span class="co">#&gt; [64] plyr_1.8.6             grid_4.1.0             parallel_4.1.0        </span>
<span class="co">#&gt; [67] crayon_1.4.1           lattice_0.20-44        Biostrings_2.60.2     </span>
<span class="co">#&gt; [70] splines_4.1.0          multtest_2.48.0        knitr_1.34            </span>
<span class="co">#&gt; [73] pillar_1.6.2           igraph_1.2.6           reshape2_1.4.4        </span>
<span class="co">#&gt; [76] codetools_0.2-18       stats4_4.1.0           glue_1.4.2            </span>
<span class="co">#&gt; [79] evaluate_0.14          data.table_1.14.0      vctrs_0.3.8           </span>
<span class="co">#&gt; [82] foreach_1.5.1          gtable_0.3.0           purrr_0.3.4           </span>
<span class="co">#&gt; [85] assertthat_0.2.1       cachem_1.0.6           xfun_0.25             </span>
<span class="co">#&gt; [88] ragg_1.1.3             survival_3.2-13        tibble_3.1.4          </span>
<span class="co">#&gt; [91] iterators_1.0.13       memoise_2.0.0          IRanges_2.26.0        </span>
<span class="co">#&gt; [94] cluster_2.1.2          ellipsis_0.3.2         ROCR_1.0-11</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Xiangnan Xu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
